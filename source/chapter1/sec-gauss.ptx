<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec-gauss" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Gauss-Jordan elimination</title>
  <p>
    By this point I hope that you are convinced that solutions to linear systems in reduced row echelon form are easy to find. The question now is whether and how we can put a linear system in reduced row echelon form. We can always do so using elementary row operations. The process is known as <em>Gauss-Jordan elimination</em>.
  </p>
  <p>
    This process consists of several steps. I will describe them now in full generality, but will use a concrete matrix so that we can see how the matrix is changed along the way. Since the purpose of this algorithm is to solve systems of linear equations, I will also display alongside the matrix the corresponding system of linear equations that we get at each step. In practice, we would not write the linear system every step of the way. We would work solely with the matrix, and we would translate the information in the last matrix back in terms of the variables in the initial system. 
  </p>
  <p>
    The linear system/matrix pair that we will use is
    <me>
        \left\{
        \begin{alignedat}{9}
            3y \ampp - \ampp 2z \ampp + \ampp w \amp = \ampp 0\\
            2x \ampp + \ampp 3y \ampp + \ampp z \amp = \ampp 1\\
            \ampp \ampp 3x \ampp + \ampp 2w \amp = \ampp 3
        \end{alignedat}\right.,\qquad\qquad\qquad
        \left(
        \begin{array}{cccc|c}
            0 \amp 3 \amp -2 \amp 1 \amp 0\\
            2 \amp 3 \amp 1 \amp 0 \amp 1\\
            3 \amp 0 \amp 0 \amp 2 \amp 3\\
        \end{array}
        \right)
    </me>.   
</p>
<p>
    <alert>Step 1.</alert> Start by identifying the leftmost column that does not consist entirely of zeroes. If the top entry of that column is a <m>0</m>, swap the top row with the first row which has a non-zero entry in that column.
</p>
<p>
    In the augmented matrix above, that is column <m>1</m>. Note that the top entry in column <m>1</m> is <m>0</m> which means that we will need to swap the top row with some another row in order to make the first entry in column <m>1</m> be non-zero. Let's go ahead and swap the first two rows. We end up with
    <me>
        \left\{
            \begin{alignedat}{7}
                2x \ampp + \ampp 3y \ampp + \ampp z \amp = \ampp 1\\
                3y \ampp - \ampp 2z \ampp + \ampp w \amp = \ampp 0\\
                \ampp \ampp 3x \ampp + \ampp 2w \amp = \ampp 3\\
            \end{alignedat}
        \right.\qquad\qquad\qquad
        \left(
            \begin{array}{cccc|c}
                2 \amp 3 \amp 1 \amp 0 \amp 1\\
                0 \amp 3 \amp -2 \amp 1\amp 0\\
                3 \amp 0 \amp 0 \amp 2 \amp 3\\
            \end{array}
        \right)
    </me>.
</p>
<p>
    <alert>Step 2.</alert> The top entry in the column identified in step <m>1</m> is non-zero. If that entry is a number <m>a\neq 1</m>, divide the whole top row by <m>a</m>.
</p>
<p>
    The first entry in the first column is a <m>2</m>, so we will need to divide the top row by <m>2</m>. After performing this operation, we obtain
    <me>
        \left\{
            \begin{alignedat}{7}
                x \ampp + \ampp \frac{3}{2}y \ampp + \ampp \frac{1}{2}z \amp = \ampp \frac{1}{2}\\
                3y \ampp - \ampp 2z \ampp + \ampp w \amp = \ampp 0\\
                \ampp \ampp 3x \ampp + \ampp 2w \amp = \ampp 3
            \end{alignedat}
        \right.\qquad\qquad\qquad
        \left(
            \begin{array}{cccc|c}
            1 \amp \frac{3}{2} \amp \frac{1}{2} \amp 0 \amp \frac{1}{2}\\
            0 \amp 3 \amp -2 \amp 1 \amp 0\\
            3 \amp 0 \amp 0 \amp 2 \amp 3
            \end{array}
        \right)
    </me>.
</p>
<p>
    <alert>Step 3.</alert> The top row now has a leading <m>1</m>. Add multiples of the top row to the rows below to ensure that the only non-zero entry in the column of steps <m>1</m> and <m>2</m> is the leading <m>1</m> in the top row.
</p>
<p>
    Currently, our matrix's first column has a <m>1</m> in the first entry, a <m>0</m> in the second, and a <m>3</m> in the last entry. We need to get rid of that <m>3</m>. In order to do that, we take the last row and remove <m>3</m> times the first row. We end up with
    <me>
        \left\{
            \begin{alignedat}{7}
                x \ampp + \ampp \frac{3}{2}y \ampp + \ampp \frac{1}{2}z \amp = \ampp \frac{1}{2}\\
                3y \ampp - \ampp 2z \ampp + \ampp w \amp = \ampp 0\\
                -\frac{9}{2}y \ampp - \ampp \frac{3}{2}z \ampp + \ampp 2w \amp = \ampp \frac{3}{2}
            \end{alignedat}
        \right.\qquad\qquad\qquad
        \left(
            \begin{array}{cccc|c}
                1 \amp \frac{3}{2} \amp \frac{1}{2} \amp 0 \amp \frac{1}{2}\\
                0 \amp 3 \amp -2 \amp 1 \amp 0\\
                0 \amp -\frac{9}{2} \amp -\frac{3}{2} \amp 2 \amp \frac{3}{2}
            \end{array}
        \right)
    </me>.
</p>
<p>
    <alert>Step 4.</alert> Now consider the submatrix obtained from the original matrix after removing the top row. Perform steps <m>1</m> to <m>4</m> on that submatrix.
</p>
<p>
    This is usually the longest step. In our example, the submatrix in question is <m>\left(\begin{array}{cccc|c}0 \amp 3 \amp -2 \amp 1 \amp 0\\0 \amp -\frac{9}{2} \amp -\frac{3}{2} \amp 2 \amp \frac{3}{2}\end{array}\right)</m>. The leftmost column with non-zero entries is column <m>2</m>, and the top row of that column is already non-zero. This means that we can go immediately to step <m>2</m> and divide the top row of the submatrix (second row of original matrix) by <m>3</m>. We get
    <me>
        \left\{
            \begin{alignedat}{7}
                x \ampp + \ampp \frac{3}{2}y \ampp + \ampp \frac{1}{2}z \amp = \ampp \frac{1}{2}\\
                y \ampp - \ampp \frac{2}{3}z \ampp + \ampp \frac{1}{3}w \amp = \ampp 0\\
                -\frac{9}{2}y \ampp - \ampp \frac{3}{2}z \ampp + \ampp 2w \amp = \ampp \frac{3}{2}
            \end{alignedat}
        \right.\qquad\qquad\qquad
        \left(
            \begin{array}{cccc|c}
                1 \amp \frac{3}{2} \amp \frac{1}{2} \amp 0 \amp \frac{1}{2}\\[6pt]
                0 \amp 1 \amp -\frac{2}{3} \amp \frac{1}{3} \amp 0\\[6pt]
                0 \amp -\frac{9}{2} \amp -\frac{3}{2} \amp 2 \amp \frac{3}{2}
            \end{array}
        \right)
    </me>.
    Now we will need to add <m>9/2</m> times the second row of our matrix to the last row. After doing that, we obtain
    <me>
        \left\{
            \begin{alignedat}{7}
            x \ampp + \ampp \frac{3}{2}y \ampp + \ampp \frac{1}{2}z \amp = \ampp \frac{1}{2}\\
            y \ampp - \ampp \frac{2}{3}z \ampp + \ampp \frac{1}{3}w \amp = \ampp 0\\
            \ampp - \ampp \frac{9}{2}z \ampp + \ampp \frac{7}{2}w \amp = \ampp \frac{3}{2}
            \end{alignedat}
        \right.\qquad\qquad\qquad
        \left(
            \begin{array}{cccc|c}
            1 \amp \frac{3}{2} \amp \frac{1}{2} \amp 0 \amp \frac{1}{2}\\[6pt]
            0 \amp 1 \amp -\frac{2}{3} \amp \frac{1}{3} \amp 0\\[6pt]
            0 \amp 0 \amp -\frac{9}{2} \amp \frac{7}{2} \amp \frac{3}{2}
            \end{array}
        \right)
    </me>.
    Finally, we need to multiply the last row of the matrix by <m>-2/9</m> to get
    <me>
        \left\{
            \begin{alignedat}{7}
            x \ampp + \ampp \frac{3}{2}y \ampp + \ampp \frac{1}{2}z \amp = \ampp \frac{1}{2}\\
            y \ampp - \ampp \frac{2}{3}z \ampp + \ampp \frac{1}{3}w \amp = \ampp 0\\
            \ampp  \ampp z \ampp - \ampp \frac{7}{9}w \amp = \ampp -\frac{1}{3}
            \end{alignedat}
        \right.\qquad\qquad\qquad
        \left(
            \begin{array}{cccc|c}
            1 \amp \frac{3}{2} \amp \frac{1}{2} \amp 0 \amp \frac{1}{2}\\[6pt]
            0 \amp 1 \amp -\frac{2}{3} \amp \frac{1}{3} \amp 0\\[6pt]
            0 \amp 0 \amp 1 \amp -\frac{7}{9} \amp -\frac{1}{3}
            \end{array}
        \right)
    </me>.
</p>
<p>
    <alert>Step 5.</alert> Starting in the last row and working upward, add a suitable multiple of each of the lower rows to the ones above to enure that each pivot column only has a <m>1</m> in the pivot position and <m>0</m>s everywhere else.
</p>
<p>
    We will first add <m>2/3</m> times the last row to the second row, and <m>-1/2</m> times the last row to the first one. The new system and matrix that we get are
    <me>
        \left\{
            \begin{alignedat}{7}
                x \ampp + \ampp \frac{3}{2}y \ampp + \ampp \frac{7}{18}w \amp = \ampp \frac{2}{3}\\
                \ampp \ampp y \ampp - \ampp \frac{5}{27}w \amp = -\ampp \frac{2}{9}\\
                \ampp \ampp z \ampp - \ampp \frac{7}{9}w \amp = -\ampp \frac{1}{3}
            \end{alignedat}
        \right.\qquad\qquad\qquad
        \left(
            \begin{array}{cccc|c}
            1 \amp \frac{3}{2} \amp 0 \amp \frac{7}{18} \amp \frac{2}{3}\\[6pt]
            0 \amp 1 \amp 0 \amp -\frac{5}{27} \amp -\frac{2}{9}\\[6pt]
            0 \amp 0 \amp 1 \amp -\frac{7}{9} \amp -\frac{1}{3}
            \end{array}
        \right)
    </me>.
    Now we only need to add <m>-3/2</m> times the second row to the first row to get the linear system in reduced row echelon form that we were seeking:
    <me>
        \left\{
            \begin{aligned}
                x+\frac{2}{3}w \amp =1\\
                y-\frac{5}{27}w \amp =-\frac{2}{9}\\
                z-\frac{7}{9}w \amp =-\frac{1}{3}
            \end{aligned}
        \right.\qquad\qquad\qquad
        \left(
            \begin{array}{cccc|c}
            1 \amp 0 \amp 0 \amp \frac{2}{3} \amp 1\\[6pt]
            0 \amp 1 \amp 0 \amp -\frac{5}{27} \amp -\frac{2}{9}\\[6pt]
            0 \amp 0 \amp 1 \amp -\frac{7}{9} \amp -\frac{1}{3}
            \end{array}
        \right)
    </me>.
</p>
<p>
    Now that we have reduced the system to one the reduced row echelon form, we can easily find all the solutions. First note that there are three leading variables, <m>x,y</m> and <m>z</m>, and one free variable, <m>w</m>. This means that all the solutions to this system of linear equations are given parametrically by
    <me>
        x=1-\frac{2}{3}t,\quad y=-\frac{2}{9}+\frac{5}{27}t,\quad z=-\frac{1}{3}+\frac{7}{9}t,\quad w=t
    </me>
    where <m>t\in\R</m>.
</p>
<p>
    The process of Gauss-Jordan elimination can be used to show the following theorem.
</p>
<theorem xml:id="thm-gauss">
    <title>Gauss-Jordan elimination</title>
    
    
    <statement>
        <p>
            A linear system with <m>m</m> variables and <m>n</m> equations is equivalent to a linear system with <m>m</m> variables and <m>n</m> equations in reduced row echelon form.  Moreover, a homogeneous linear system with <m>m</m> variables and <m>n</m> equations is equivalent to a homogeneous linear system with <m>m</m> variables and <m>n</m> equations.
        </p>
    </statement>
</theorem>

<example>
    <p>
        Let's use Gauss-Jordan elimination to solve
        <me>
            \left\{
                \begin{alignedat}{7}
                    x \ampp + \ampp y \ampp - \ampp z \amp = \ampp 0\\
                    \ampp \ampp 2x \ampp - \ampp y \amp = \ampp 1\\
                    \ampp \ampp 2x \ampp + \ampp 2z \amp = \ampp 3
                \end{alignedat}
            \right.
        </me>.
        The corresponding augmented matrix is
        <me>
            \left(
            \begin{array}{ccc|c}
                1 \amp 1 \amp -1 \amp 0\\
                2 \amp -1 \amp 0 \amp 1\\
                2 \amp 0 \amp 2 \amp 3
            \end{array}    
            \right)
        </me>.
        First, we subtract <m>2</m> times the first row from the second and third rows to get:
        <me>
            \left(
            \begin{array}{ccc|c}
                1 \amp 1 \amp -1 \amp 0\\
                0 \amp -3 \amp 2 \amp 1\\
                0 \amp -2 \amp 4 \amp 3
            \end{array}    
            \right)
        </me>.
        Next, we multiply the second row by <m>-1/3</m>:
        <me>
            \left(
            \begin{array}{ccc|c}
                1 \amp 1 \amp -1 \amp 0\\[6pt]
                0 \amp 1 \amp -\frac{2}{3} \amp -\frac{1}{3}\\[6pt]
                0 \amp -2 \amp 4 \amp 3            
            \end{array}    
            \right)
        </me>.
        Adding ,<m>2</m> times the second row to the last one, we obtain
        <me>
            \left(
            \begin{array}{ccc|c}
                1 \amp 1 \amp -1 \amp 0\\[6pt]
                0 \amp 1 \amp -\frac{2}{3} \amp -\frac{1}{3}\\[6pt]
                0 \amp 0 \amp \frac{8}{3} \amp \frac{7}{3}
            \end{array}
            \right)
        </me>.
        Now we multiply the last row by <m>3/8</m>:
        <me>
            \left(
            \begin{array}{ccc|c}
                1 \amp 1 \amp -1 \amp 0\\[6pt]
                0 \amp 1 \amp -\frac{2}{3} \amp -\frac{1}{3}\\[6pt]
                0 \amp 0 \amp 1 \amp \frac{7}{8}
            \end{array}
            \right)
        </me>.
        We are almost there. We now need to add <m>2/3</m> times the last row to the second one and add the last row to the first row.
        <me>
            \left(
            \begin{array}{ccc|c}
                1 \amp 1 \amp 0 \amp \frac{7}{8}\\[6pt]
                0 \amp 1 \amp 0 \amp \frac{1}{4}\\[6pt]
                0 \amp 0 \amp 1 \amp \frac{7}{8}
            \end{array}
            \right)
        </me>.
        Finally, we only need to subtract the second row from the first, and we get the following augmented matrix in reduced row echelon form:
        <me>
            \left(
            \begin{array}{ccc|c}
                1 \amp 0 \amp 0 \amp \frac{5}{8}\\[6pt]
                0 \amp 1 \amp 0 \amp \frac{1}{4}\\[6pt]
                0 \amp 0 \amp 1 \amp \frac{7}{8}
            \end{array}
            \right)
        </me>.
        from where we deduce that the only solution to our linear system is <m>x=\frac{5}{8}, y=\frac{1}{4}, z=\frac{7}{8}</m>.
        
    </p>
</example>
<theorem xml:id="thm-homoginf">
    <statement>
        <p>
            A homogeneous linear system with more variables than equations has infinitely many solutions.
        </p>
    </statement>
    <proof>
        <p>
            Let <m>m</m> be the number of variables and <m>n</m> the number of equations. We have <m>m>n</m>. We know from <xref ref="thm-gauss"/> that this system is equivalent to a homogeneous linear system with <m>m</m> equations and <m>n</m> variables in reduced row echelon form. So all we need to do is to show that a homogeneous linear system in reduced row echelon form that has more variables than equations admits infinitely many solutions. It will suffice to show that such a system has at least one free variable.
        </p>
        <p>
            Since such a system is homogeneous, it must be consistent, i.e. it must have at least one solution, namely the trivial solution where all the variables are assigned the value <m>0</m>. From <xref ref="lem-nfree"/> we know that this system has at most <m>n</m> leading variables, and so the remaining variables are free. By assumption, the number of variables <m>m</m> is strictly larger than <m>n</m>, so our linear system has at least one free variable, and so will admit infinitely many solutions.
        </p>
    </proof>
</theorem>
<exercises xml:id="exercises-ch1-sec3">
    <exercise>
        <statement>
            <p>
                Use Gauss-Jordan elimination to solve the following linear systems of equations.
            </p>
            <ol marker="(a)">
                <li>
                    <p>
                        <me>
                            \left\{
                                \begin{alignedat}{5}
                                    x \ampp - \ampp 2y  \amp = \ampp 2\\
                                    2x \ampp + \ampp 3y \amp = \ampp 1
                                \end{alignedat}
                            \right.
                        </me>
                    </p>
                </li>

                <li>
                    <p>
                        <me>
                            \left\{
                                \begin{alignedat}{5}
                                    3x \ampp + \ampp y  \amp = \ampp 1\\
                                    6x \ampp + \ampp 2y \amp = \ampp 1
                                \end{alignedat}
                            \right.
                        </me>
                    </p>
                </li>

                <li>
                    <p>
                        <me>
                            \left\{
                                \begin{alignedat}{5}
                                    3x \ampp + \ampp y  \amp = \ampp 1\\
                                    6x \ampp + \ampp 2y \amp = \ampp 2
                                \end{alignedat}
                            \right.
                        </me>
                    </p>
                </li>

                <li>
                    <p>
                        <me>
                            \left\{
                                \begin{alignedat}{5}
                                    y \ampp - \ampp z  \amp = -\ampp 1\\
                                    x \ampp + \ampp 2y \amp = \ampp 2\\
                                    2x \ampp - \ampp z \amp = \ampp 0
                                \end{alignedat}
                            \right.
                        </me>
                    </p>
                </li>

                <li>
                    <p>
                        <me>
                            \left\{
                                \begin{alignedat}{5}
                                    y \ampp + \ampp 2z  \amp = -\ampp 1\\
                                    3y \ampp + \ampp 2w \amp = \ampp 2\\
                                    2x \ampp - \ampp w \amp = \ampp 0
                                \end{alignedat}
                            \right.
                        </me>
                    </p>
                </li>

                <li>
                    <p>
                        <me>
                            \left\{
                                \begin{alignedat}{5}
                                    x \ampp - \ampp z  \amp = \ampp 1\\
                                    x \ampp + \ampp y \amp = \ampp 0\\
                                    y \ampp + \ampp z \amp = \ampp 0
                                \end{alignedat}
                            \right.
                        </me>
                    </p>
                </li>
                <li>
                    <p>
                        <me>
                            \left\{
                                \begin{alignedat}{7}
                                    \ampp \ampp x \ampp - \ampp z  \amp = \ampp 1\\
                                    \ampp \ampp x \ampp + \ampp y \amp = \ampp 0\\
                                    x \ampp - \ampp y \ampp - \ampp 2z \amp = \ampp 2
                                \end{alignedat}
                            \right.
                        </me>
                    </p>
                </li>

                <li>
                    <p>
                        <me>
                            \left\{
                                \begin{alignedat}{7}
                                    y \ampp + \ampp z \ampp + \ampp w  \amp = \ampp 1\\
                                    x \ampp + \ampp 2y \ampp +\ampp w \amp = \ampp 0
                                \end{alignedat}
                            \right.
                        </me>
                    </p>
                </li>
            </ol>
        </statement>
    </exercise>
</exercises>
</section>